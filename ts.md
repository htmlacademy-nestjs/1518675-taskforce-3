# Проект «TaskForce»

> Цели этого файла помочь студенту максимально качественно подготовится к защите, чтобы не пропустить ни один пунки ТЗ.
> Ведь не выполнение хотя бы одного пунта нарушает быловый кретерий защиты Б1
>
> - ⏳ студент еще не приступал к заданию
> - ☑ задание выполнено студентом, но еще не было проверено наставником
> - ✅ задание проверено наставником и удовлетворяет условию ТЗ
> - ❌ задание проверено наставником и оно **НЕ** удовлетворяет условию ТЗ
>
> #### Workflow
>  - Студент берёт пункт ТЗ со значком ⏳ или ❌
>  - После его выполнения, студент ставит ☑
>
>  После проверки наставником, оно переходит в статус ✅ - если все хорошо или ❌ - если требует доработок


### О проекте
«TaskForce» — это онлайн площадка для поиска исполнителей на разовые задачи. Сайт функционирует как биржа объявлений, где заказчики — физические лица публикуют задания. Исполнители могут откликаться на эти задания, предлагая свои услуги и стоимость работ.

### Общая концепция проекта
Вам предстоит разработать бэкенд для биржи объявлений. Каждое объявление — это отдельная задача на поиск исполнителей для решения какой-либо задачи. Бэкенд реализует разные пользовательские сценарии: от регистрации до публикации объявлений.

### Технические требования
Для разработки проекта применяется микросервисная архитектура. Студент самостоятельно определяет список микросервисов для приложения. Общее требование к сервисам: каждый сервис решает свою задачу.

Некоторые сервисы могут содержать свою базу данных. Решение по выбору базы данных и её необходимость для определённого микросервиса остаётся на усмотрение студента. В приложении могут использоваться следующие СУБД: MongoDB, PostgreSQL.

Для лучшего понимания работы проекта, студенту предоставляется полный набор вёрстки. Создавать из неё готовый фронтенд НЕ нужно. В рамках курса мы разрабатываем только бэкенд.

⏳ В корневой директории проекта размещается файл specification.md. Файл содержит все необходимые инструкции для запуска проекта.

⏳ Для разработки проекта используется актуальный LTS-релиз платформы Node.js. При необходимости студент может устанавливать дополнительные пакеты.

⏳ Код сервисов разрабатывается только на TypeScript. Все сервисы размещаются в монорепозитории. Для построения монорепозитория используется NX.

Техническое задание не определяет контракты и конкретные ресурсы разрабатываемого приложения. Решение по разделению приложения на сервисы, проектирование ресурсов API и другие архитектурные решения студент принимает самостоятельно.

### Общий список сценариев
- 1.1. ⏳ Регистрация новых пользователей.
- 1.2. ⏳ Авторизация пользователей на основе JWT.
- 1.3. ⏳ Создание, редактирование, удаление заданий.
- 1.4. ⏳ Просмотр детальной информации о задании.
- 1.5. ⏳ Разделение пользователей по ролям: «Исполнители», «Заказчики».
- 1.6. ⏳ Загрузка изображений для заданий.
- 1.7. ⏳ Участие в обсуждении заданий.
- 1.8. ⏳ Отклики на задания.
- 1.9. ⏳ Пагинация для списка заданий.
- 1.10. ⏳ Рассылка почтовых уведомлений на email о появлении новых заданий.
- 1.11. ⏳ Смена пароля пользователя.
- 1.12. ⏳ Расчёт рейтинга пользователя.
- 1.13. ⏳ Категоризация заданий.
- 1.14. ⏳ Фильтрация заданий.
- 1.15. ⏳ Статистика по выполненным заданиям.
- 1.16. ⏳ Отзывы.
- 1.17. ⏳ Разбивка заданий по тегам.

### Функциональность
1. Регистрация и авторизация пользователей
   - 1.1. ⏳ Регистрация доступна только анонимным клиентам.
   - 1.2. ⏳ Для регистрации клиент передаёт следующий набор информации:
     - ⏳ Имя пользователя (обязательно). Фамилия и имя пользователя. Минимальная длина поля: 3 символа, максимальная 50 символов.
     - ⏳ Электронная почта (обязательно). Используется в качестве логина. Адрес уникален: в базе данных не может быть двух пользователей с одинаковым email.
     - ⏳ Город (обязательно). Один город из списка: Москва, Санкт-Петербург, Владивосток.
     - ⏳ Пароль (обязательно). Пароль пользователя. Минимальная длина пароля 6 символов, максимальная 12.
     - ⏳ Роль пользователя (обязательно). В приложении реализовано два вида ролей: «Заказчик» (публикует новые задания), «Исполнитель» (откликается на заявки).
     - ⏳ Аватар пользователя (опционально). Фотография для аватарки пользователя. Ограничения: не больше 500 килобайт, формат jpeg или png.
     - ⏳ Дата рождения (обязательно). Дата рождения пользователя в формате: YYYY-MM-DD. Ограничения: валидная дата, пользователь достиг совершеннолетия (18 лет).
   - 1.3. ⏳ Перед записью информации в базу данных, выполняется процесс валидации. В случае обнаружения ошибок, полный список отправляется клиенту.
   - 1.4. ⏳ Загруженные изображения для аватара могут хранится как в файловой системе, так и в базе данных.
   - 1.5. ⏳ Приложение фиксирует дату регистрации пользователя. Дата регистрации пользователя используется для внутренних нужд.
   - 1.6. ⏳ Пароль пользователя не хранится в базе данных в открытом виде. Вместо пароля в базе хранится его хеш. Для выполнения хеширования применяется пакет bcrypt.
   - 1.7. ⏳ В случае успешной регистрации пользователя, приложение возвращает корректный код состояния и объект с информацией о созданном пользователе. Все необходимые контракты определяются студентом самостоятельно.
   - 1.8. ⏳ Авторизация пользователей построена на основе JWT. После успешной проверки логина и пароля, приложение возвращает JWT токен. Токен содержит payload со всей необходимой информацией.
   - 1.9. ⏳ Авторизованный пользователь может сменить свой пароль. Для изменения пароля пользователь передаёт следующий набор информации:
     - ⏳ Текущий пароль (обязательно).
     - ⏳ Новый пароль (обязательно). Минимальная длина 6 символов, максимальная 12. Перед изменением пароля проверяется, что переданный пользователем текущий пароль соответствует тому, что сохранён в базе.
   - 1.10. ⏳ Пользователи не могут изменить роль, полученную при регистрации.
   - 1.11. ⏳ Пользователь может запросить детальную информацию по определенному пользователю. Информация запрашивается по идентификатору пользователя. Возвращаемая информация зависит от роли пользователя, по которому запрашивается информация.
     - **Если запрашивают информацию по заказчику:**
       - ⏳ Имя пользователя;
       - ⏳ Уникальный идентификатор пользователя;
       - ⏳ Дата регистрации;
       - ⏳ Город;
       - ⏳ Email;
       - ⏳ Количество опубликованных заданий;
       - ⏳ Количество заданий со статусом «Новый»;
       - ⏳ Информация о себе;
       - ⏳ Вид/роль пользователя.
     - **Если запрашивают информацию по исполнителю:**
       - ⏳ Имя пользователя;
       - ⏳ Уникальный идентификатор пользователя;
       - ⏳ Дата регистрации;
       - ⏳ Город;
       - ⏳ Возраст в годах (например, 30 лет);
       - ⏳ Вид/роль пользователя;
       - ⏳ Рейтинг исполнителя;
       - ⏳ Количество выполненных заданий;
       - ⏳ Количество проваленных заданий;
       - ⏳ Email;
     - **Информация о себе;**
       - ⏳ Специализация;
       - ⏳ Место в рейтинге.
   - 1.12. ⏳ Авторизованный пользователь может изменить информацию о себе:
     - ⏳ Имя пользователя. Минимальная длина поля: 3 символа, максимальная 50 символов.
     - ⏳ Дата рождения. Дата рождения пользователя в формате: YYYY-MM-DD. Ограничения: валидная дата, пользователь достиг совершеннолетия (18 лет).
     - ⏳ Информация о себе. Максимальная длина: 300 символов;
     - ⏳ Специализация. Список навыков пользователя (один или несколько вариантов). Ограничения: не больше 5 вариантов. Дубли автоматически удаляются.
     - ⏳ Город. Один город из списка: Москва, Санкт-Петербург, Владивосток. Пользователь может обновить сразу все поля или несколько из них.
2. Работа с заданиями
   - 2.1. ⏳ Создавать, редактировать, удалять задания могут только авторизованные пользователи с ролью «Заказчик».
   - 2.2. ⏳ Заказчики могут редактировать и удалять задания, созданные ими. Удаление и редактирование заданий происходит по уникальному идентификатору.
   - 2.3. ⏳ Удаление задания приводит к удалению всех оставленных к нему комментариев.
   - 2.4. ⏳ Для создания нового задания заказчик передаёт следующий набор информации:
     - ⏳ Заголовок (обязательно). Минимальная длина 20 символов, максимальная 50.
     - ⏳ Детальное описание задания (обязательно). Минимальная длина 100 символов, максимальная: 1024 символа.
     - ⏳ Категория задания (обязательно). Одна из существующих категорий. Авторизованные пользователи с ролью «Заказчик» могут создавать новые категории. Перед созданием новой категории выполняется проверка на существование категории с таким же именем. Если обнаруживается дубль, то новая категория не создаётся.
     - ⏳ Стоимость (опционально). Неотрицательное число. Сумма может быть произвольной, в том числе и нулём.
     - ⏳ Срок исполнения (опционально). Валидная дата для выполнения задания. Выбранная дата исполнения не может быть меньше текущей даты.
     - ⏳ Изображение (опционально). Максимальный размер изображения: 1 мегабайт. Допускаются форматы: jpg, png.
     - ⏳ Адрес (опционально). Адрес, где необходимо выполнять задание. Минимальная длина 10 символов, максимальная 255.
     - ⏳ Набор тегов (опционально). Список тегов к заданию. Ограничения и требования к тегам приведены в разделе «Теги к заданию».
     - ⏳ Город (обязательно). Один город из списка: Москва, Санкт-Петербург, Владивосток.
   - 2.5. ⏳ Автор задания определяется автоматически во время сохранения в базу данных.
   - 2.6. ⏳ Для каждого задания автоматически сохраняется дата его создания.
   - 2.7. ⏳ Задание может находиться в одном из пяти статусов:
     - ⏳ «Новое». Сразу после публикации. Исполнитель ещё не найден.
     - ⏳ «Отменено». Заказчик отменил задание. Переход к этому статусу возможен только со статуса «Новое».
     - ⏳ «В работе». Заказчик выбрал исполнителя для задания. Переход к этому статусу возможен только со статуса «Новое» и после выбора исполнителя.
     - ⏳ «Выполнено». Заказчик отметил задание выполненным. Переход к этому статусу возможен только со статуса «В работе».
     - ⏳ «Провалено». Исполнитель отказался от выполнения задания. Переход к этому статусу возможен только со статуса «В работе». Переход между статусами визуализирован на схеме (смотри рисунок 1).
   - 2.8. ⏳ Приложение предоставляет заказчику возможность изменять статус задания. При изменении статуса проверяется корректность перехода к новому статусу. Если переход к новому статусу нарушает схему, представленную на рисунке 1, возникает ошибка и статус задания не меняется.
   - 2.9. ⏳ Пользователи с ролью «Исполнитель» могут откликаться на опубликованные задания со статусом «Новое». Отклики фиксируются, чтобы заказчик мог выбрать исполнителя из числа откликнувшихся.
   - 2.10. ⏳ Для перевода задания в статус «В работе», заказчику необходимо выбрать исполнителя из списка откликнувшихся. Заказчик может выбрать исполнителя только из данного списка.
   - 2.11. ⏳ Заказчик может назначить на выполнение задания исполнителя, у которого в данный момент нет заданий в работе.
   - 2.12. ⏳ Перевод задания в статус «Провалено» может сделать только исполнитель задания.
   - 2.13. ⏳ Пользователи могут запрашивать детальную информацию по заданию. Запрос детальной информации происходит по уникальному идентификатору. Детальная информация включает полную информацию о задании (который вводит заказчик), текущий статус задания, а также уникальный идентификатор задания.

3. Список заданий
   - 3.1. ⏳ Авторизованные пользователи с ролью «Исполнитель» могут запрашивать список заданий со статусом «Новый». Приложение возвращает список из последних 25 заданий.
   - 3.2. ⏳ Пользователь может запросить следующие 25 (пагинация) или оставшиеся заданий (если их меньше 25). Для этого он передаёт дополнительные данные в запрос.
   - 3.3. ⏳ Пользователь может запросить задания, относящиеся к определённой категории или к определённому тегу. При запросе новых заданий из определённой категории или по определённому тегу действуют те же правила и ограничения (количество, пагинация) перечисленные в пунктах 3.1, 3.2.
   - 3.4. ⏳ Помимо фильтрации заданий по категории, тегу, пользователь может ограничивать список заданий определённым городом: Москва, Санкт-Петербург, Владивосток.
   - 3.5. ⏳ По умолчанию приложение возвращает список заданий, отсортированных по дате создания (по убыванию). Пользователь может передать дополнительные параметры и изменить вариант сортировки. Доступные варианты сортировки:
     - ⏳ Дата создания (по убыванию). Вариант сортировки по умолчанию;
     - ⏳ Популярные (по убыванию). Задания с наибольшим количеством откликов. Сначала с наибольшим количеством откликов;
     - ⏳ Обсуждаемые (по убыванию). Задания с наибольшим количеством комментариев. Сначала комментарии с наибольшим количеством комментариев.
   - 3.6. ⏳ Каждое задание в списке помимо информации о самом задании содержит: количество откликов, количество комментариев, дата создания задания, информация об авторе (имя, фамилия, идентификатор, email).
   - 3.7. ⏳ Если отдельный сервис не содержит определённой части информации, то он возвращает только идентификаторы. Недостающая информация может быть добавлена в BFF.

4. Мои задания
   - 4.1. ⏳ Приложение предоставляет пользователям возможность получать список заданий, закреплённых за ними. Когда список «Мои задания» запрашивает заказчик, он получает список созданных им заданий. Когда этот же список запрашивает исполнитель, он получает список заданий, в которых он является исполнителем. Для заказчика список отсортирован по дате создания (по убыванию), а для исполнителя по статусу задания (задания со статусом «новый» в начале списка).
   - 4.2. ⏳ Пользователь может передавать дополнительную информацию приложению и фильтровать список «Мои задания» по статусу. Это позволяет получить задания с определённым статусом. Например, только задания со статусом «В процессе».

5. Комментарии
   - 5.1. ⏳ Комментарии заданиям могут добавлять только авторизованные пользователи. Комментарии могут создавать как пользователи с ролью «Заказчик», так и с ролью «Исполнитель».
   - 5.2. ⏳ Для создания нового комментария пользователь передаёт следующую информацию:
     - ⏳ Текст комментария (обязательно). Минимальная длина: 10 символов, максимальная: 300.
     - ⏳ Идентификатор задания (обязательно). Задание, для которого создаётся комментарий.
   - 5.3. ⏳ Информацию об авторе комментария, дату создания комментария приложение определяет автоматически.
   - 5.4. ⏳ Пользователь может удалить свой комментарий. Удаление комментариев других пользователей запрещено. Удаление комментариев производится по уникальному идентификатору комментария.
   - 5.5. ⏳ Для любого задания пользователь (в том числе и анонимный) может запросить список комментариев. По умолчанию приложение возвращает список из 50 комментариев.
   - 5.6. ⏳ Пользователь может запросить следующие 50 комментариев (или оставшиеся, если их меньше). Для этого он передаёт дополнительную информацию в запрос.

6. Уведомления на email
   - 6.1. ⏳ Приложение умеет рассылать уведомления о заданиях на email.
   - 6.2. ⏳ Уведомления рассылаются всем зарегистрированным пользователям с ролью «Исполнитель».
   - 6.3. ⏳ Письмо с информацией об обновлениях содержит список новых заданий с момента последней рассылки. Проверка текущего статуса задания перед рассылкой не производится.
   - 6.4. ⏳ Оформление письма остаётся на усмотрение студента.
   - 6.5. ⏳ Запуск рассылки уведомлений осуществляется по запросу пользователя.

7. Отзывы
   - 7.1. ⏳ Пользователи с ролью «Заказчик» могут оставлять отзывы по исполнителям.
   - 7.2. ⏳ Заказчики могут оставить отзыв только по тем исполнителям, которые выполняли его задания.
   - 7.3. ⏳ Заказчик может оставить только один отзыв и оценить исполнителя (поставить оценку) по каждому заданию. Одно выполненное задание — один отзыв.
   - 7.4. ⏳ Для создания отзыва пользователь с ролью «Заказчик» передаёт:
     - ⏳ Текст отзыва. Минимум 50 символов, максимум 500 символов;
     - ⏳ Уникальный идентификатор задания со статусом «Выполнено»;
     - ⏳ Оценка исполнителя. Число от 1 до 5. Приложение автоматически фиксирует информацию об авторе отзыва и дату создания отзыва.
   - 7.5. ⏳ На основании проставленных оценок рассчитывается рейтинг исполнителя. Рейтинг исполнителя рассчитывается по формуле: сумма всех оценок из отзывов / (количество отзывов + счетчик проваленных заданий).

8. Backend For Frontend
   - 8.1. ⏳ Backend for Frontend (BFF) — это отдельный сервис, который взаимодействует с другими сервисами приложения и готовит данные для фронтенда.
   - 8.2. ⏳ Для реализации некоторых сценариев требуется взаимодействовать с несколькими сервисами. Например, если за сервис пользователей отвечает отдельный микросервис, а за управление заданиями отвечает другой микросервис, то на уровне BFF может быть реализована логика соединения ответов от сервисов с целью форматирования данных, чтобы ими было удобней пользоваться на стороне фронтенда.

### Теги к заданиям
- ⏳ Теги для заданий опциональны.
- ⏳ Любой тег состоит из одного слова и не может содержать пробелы.
- ⏳ Максимальное количество тегов к заданию: 5 штук.
- ⏳ Все теги хранятся в нижнем регистре. Пользователь может отправлять теги в любом регистре, при сохранении теги приводятся нижнему регистру.
- ⏳ Теги не повторяются. Клиент может отправить несколько одинаковых тегов для задания. Это не должно приводить к ошибкам. Дубли автоматически удаляются.
- ⏳ Тег должен начинаться с буквы. Минимальная длина тега: 3 символа. Максимальная: 10.
- ⏳ Передача для задания больше 5 тегов приводит к ошибке валидации.

### Документирование
⏳ Сервисы, предоставляющие REST API содержат документацию в формате OpenAPI. Документирование выполняется с помощью встроенных средств в фреймворк Nest.

### Безопасность
⏳ В коде приложения не должно быть зашито конфиденциальной информации: пароли, секреты и так далее.
Для передачи секретов, паролей и другой конфиденциальной информации используются переменные окружения.
Если требуется написать SQL-запрос, который принимает параметры, то используются параметризованные запросы.

### Необязательные задания
В этом разделе перечислены дополнительные задания. Невыполнение этих заданий не влияет на защиту проекта по базовым критериям.
Необязательные сценарии:
- Backend For Fronted.
